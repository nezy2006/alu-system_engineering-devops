#!/usr/bin/env bash
# Configures Nginx on a new Ubuntu machine to redirect /redirect_me permanently

# Exit immediately if a command fails
set -e

# Update package list and install nginx
apt-get update -y
apt-get install -y nginx

# Start nginx service
service nginx start

# Create a simple homepage
echo "Holberton School" > /var/www/html/index.html

# Backup default Nginx config if not already backed up
if [ ! -f /etc/nginx/sites-available/default.bak ]; then
    cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak
fi

# Use sed to insert a location block for /redirect_me after server_name

sed -i "/server_name _;/a location /redirect_me {\n    return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\n}" /etc/nginx/sites-available/default


# Test Nginx configuration
nginx -t

# Reload Nginx to apply changes
service nginx reload

